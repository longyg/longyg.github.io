<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="朴素贝叶斯,机器学习朴素贝叶斯算法">
    <meta name="description" content="龙居雅阁是一个分享技术与经验的个人博客,分享程序人生,关注Java后端,Python,Go,JavaScript,机器学习,大数据等各种技术">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>《机器学习实战》读书笔记之四：朴素贝叶斯 | 龙居雅阁</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="龙居雅阁" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">龙居雅阁</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">龙居雅阁</div>
        <div class="logo-desc">
            
            龙居雅阁是一个分享技术与经验的个人博客,分享程序人生,关注Java后端,Python,Go,JavaScript,机器学习,大数据等各种技术
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/longyg" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/longyg" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/2.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">《机器学习实战》读书笔记之四：朴素贝叶斯</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                                <span class="chip bg-color">机器学习</span>
                            </a>
                        
                            <a href="/tags/%E7%AE%97%E6%B3%95/">
                                <span class="chip bg-color">算法</span>
                            </a>
                        
                            <a href="/tags/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/">
                                <span class="chip bg-color">朴素贝叶斯</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="post-category">
                                机器学习
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2018-09-16
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2020-07-17
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    18 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h3 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h3><p><code>朴素贝叶斯</code>是机器学习中经典的分类算法之一，应用非常广泛，它是基于概率的<code>分类算法</code>。 </p>
<p>基本思路是，通过计算某数据属于各种类型的概率，以概率最大的分类作为数据的分类。因此，该算法的关键是如何计算属于某种<code>分类的概率</code>。 </p>
<p>举个例子，如果数据有<code>A</code>和<code>B</code>两种分类，对于某未知类型的数据，我们分别计算它属于<code>A</code>和<code>B</code>的概率，假设分别为<code>P(A)</code>和<code>P(B)</code>，如果<code>P(A) &gt; P(B)</code>，则我们预测该数据属于<code>A</code>类型，反之，判定该数据属于<code>B</code>类型。</p>
<h3 id="二、贝叶斯推导"><a href="#二、贝叶斯推导" class="headerlink" title="二、贝叶斯推导"></a>二、贝叶斯推导</h3><p>要学习如何在机器学习中使用<code>贝叶斯</code>，首先我们要理解什么是贝叶斯，以及贝叶斯是如何推导而来的。 </p>
<p>在推导贝叶斯公式之前，我们首先要了解<code>条件概率</code>。因为贝叶斯其实最终就是求解条件概率。</p>
<h4 id="条件概率"><a href="#条件概率" class="headerlink" title="条件概率"></a>条件概率</h4><p><code>条件概率</code>的定义是：在给定事件B发生的情况下，事件A发生的概率，记为$P(A|B)$。 </p>
<p><a href="http://wx3.sinaimg.cn/large/bd7db87egy1fy2m54n5tnj20gu0c6q3k.jpg" target="_blank" rel="noopener"><img src="http://wx3.sinaimg.cn/large/bd7db87egy1fy2m54n5tnj20gu0c6q3k.jpg" alt></a> </p>
<p>蓝色区域为事件A发生的概率，记为<code>P(A)</code>。红色区域为事件B发生的概率，记为<code>P(B)</code>。蓝色与红色的交叉区域为事件A和事件B同时发生的概率，也称<code>联合概率</code>，记为<code>P(A∩B)</code>。 </p>
<p>那么事件B发生的情况下，事件A发生的<code>条件概率</code>是多少呢？ </p>
<p>从图中可以看出，<code>P(A|B)</code>应该是交叉区域的概率除以红色区域的概率，因此第一个<code>条件概率</code>公式为： </p>
<p>$$P(A|B) = \frac{P(A\cap B)}{P(B)}$$ </p>
<p>同理，<code>P(B|A)</code>表示事件A发生的情况下，事件B发生的概率。它应该是交叉区域的概率除以蓝色区域的概率： </p>
<p><a href="http://wx3.sinaimg.cn/large/bd7db87egy1fy2m543hg5j20gu0c6mxr.jpg" target="_blank" rel="noopener"><img src="http://wx3.sinaimg.cn/large/bd7db87egy1fy2m543hg5j20gu0c6mxr.jpg" alt></a> </p>
<p>因此第二个<code>条件概率</code>公式为： </p>
<p>$$P(B|A) = \frac{P(A\cap B)}{P(A)}$$ </p>
<p>根据第二个公式，可以得到： </p>
<p>$$P(A\cap B) = P(B|A)P(A)$$ </p>
<p>将其代入第一个公式，得到： </p>
<p>$$P(A|B) = \frac{P(B|A)P(A)}{P(B)}$$ </p>
<p>上面的公式就是<code>贝叶斯公式</code>。 </p>
<p>可以看到，条件概率<code>P(A|B)</code>可以由另外一个条件概率<code>P(B|A)</code>以及<code>P(A)</code>和<code>P(B)</code>计算而来。</p>
<h3 id="三、朴素贝叶斯应用原理"><a href="#三、朴素贝叶斯应用原理" class="headerlink" title="三、朴素贝叶斯应用原理"></a>三、朴素贝叶斯应用原理</h3><p>贝叶斯在机器学习中通常用于处理<code>分类问题</code>。基本思路是：在已知某数据的特征值的条件下，计算其属于各分类的概率，然后比较概率大小，最后以<code>概率最大的分类</code>作为该数据的分类。 </p>
<p>假如数据集总共有<code>i</code>个分类，各个分类记为符号$c_i$。 </p>
<p>那么我们要计算的<code>条件概率</code>就是以数据特征值作为条件，即在已知特征值的条件下，计算数据属于某种分类的条件概率： </p>
<p>$$P_i = P(c_i|特征值)$$ </p>
<p>假如每条数据具有<code>n</code>个特征，构成的特征向量<code>w</code>记为：$(w_1, w_2, …, w_n)$。 </p>
<p>那么要计算的条件概率实际上为： </p>
<p>$$P_i = P(c_i|w)$$ </p>
<p>如此，我们计算每个分类的概率，最终得到<code>i</code>个概率值: $(P_1, P_2, …, P_i)$。 </p>
<p>然后比较各个概率值大小，找到最大值。假设$P_2$最大，那么我们就将第<code>2</code>个分类作为该数据的分类。 </p>
<p>那么如何计算上面这<code>i</code>个概率值呢？这里我们就可以用前面介绍的<code>贝叶斯公式</code>了。即：</p>
<p>$$P_i = P(c_i|w) = \frac{P(w|c_i)P(c_i)}{P(w)}$$ </p>
<p>将$w = (w_1, w_2, …, w_n)$代入上面公式，即： </p>
<p>$$P_i = P(c_i|w) = \frac{P(w_1, w_2, …, w_n|c_i)P(c_i)}{P(w_1, w_2, …, w_n)}$$ </p>
<p>根据<code>朴素</code>贝叶斯的假设，各个特征之间是独立的，那么上面公式可以改为计算各个特征独立的<code>条件概率</code>： </p>
<p>$$P_i = P(c_i|w) = \frac{P(w_1|c_i)P(w_2|c_i) … P(w_n|c_i)P(c_i)}{P(w_1)P(w_2) … P(w_n)}$$ </p>
<p>由上面的公式可以看到，分母项是一个固定项，它对于计算每个分类的条件概率都是固定不变的。因此，我们可以将其略去，只需要比较分子的大小就可以了，<code>分子越大</code>，条件概率$P(c_i|w)$<code>越大</code>。所以我们在代码实现朴素贝叶斯时，实际上只需要计算分子： </p>
<p>$$P(w_1|c_i)P(w_2|c_i) … P(w_n|c_i)P(c_i)$$</p>
<p>$P(c_i)$很容易计算，它表示第<code>i</code>个分类的概率，即数据集中属于分类$c_i$的数据个数除以数据集总个数。举个例子，假设训练数据集总共有100条数据，其中属于第二种分类$c_2$的数据有20条，那么： </p>
<p>$$P(c_2) = \frac{20}{100} = 0.2$$ </p>
<p>那么<code>n</code>个特征的条件概率$P(w_1|c_i), P(w_2|c_i), …, P(w_n|c_i)$如何计算呢？ </p>
<p>这些概率实际上就是某分类中含某特征值的<code>条件概率</code>。这是什么意思呢？</p>
<p>举个例子来说明，某个医院早上收了6个门诊病人，如下表：</p>
<table>
<thead>
<tr>
<th>症状</th>
<th>职业</th>
<th>疾病</th>
</tr>
</thead>
<tbody><tr>
<td>打喷嚏</td>
<td>护士</td>
<td>感冒</td>
</tr>
<tr>
<td>打喷嚏</td>
<td>农夫</td>
<td>过敏</td>
</tr>
<tr>
<td>头痛</td>
<td>建筑工人</td>
<td>脑震荡</td>
</tr>
<tr>
<td>头痛</td>
<td>建筑工人</td>
<td>感冒</td>
</tr>
<tr>
<td>打喷嚏</td>
<td>教师</td>
<td>感冒</td>
</tr>
<tr>
<td>头痛</td>
<td>教师</td>
<td>脑震荡</td>
</tr>
</tbody></table>
<p>疾病有3种分类：<code>感冒</code>，<code>过敏</code>，<code>脑震荡</code>。 </p>
<p>例如我们要计算得<code>感冒</code>的人中，症状为<code>打喷嚏</code>的概率，也就是如下的条件概率： </p>
<p>$$P(打喷嚏|感冒)$$ </p>
<p>上面的6个病人中，有3个人感冒，而这3个人中症状为打喷嚏的有2个人，因此： </p>
<p>$$P(打喷嚏|感冒) = 2/3 = 0.66$$ </p>
<p>同理，我们可以计算出其他分类中各个特征的<code>条件概率</code>。</p>
<h3 id="四、朴素贝叶斯应用案例"><a href="#四、朴素贝叶斯应用案例" class="headerlink" title="四、朴素贝叶斯应用案例"></a>四、朴素贝叶斯应用案例</h3><p><code>朴素贝叶斯算法</code>的经典应用场景是用于<code>文档分类</code>。例如对邮件进行分类从而<code>过滤垃圾邮件</code>。 </p>
<p>本文将通过朴素贝叶斯算法实现一个过滤垃圾邮件的机器学习应用。 </p>
<p>前面已经介绍了朴素贝叶斯算法实际上就是求解各个分类下各个特征的条件概率。对于文档分类的应用，实际上就是求每个类别中每个词条的<code>条件概率</code>。算法伪代码如下：</p>
<pre><code>计算每个类别中的文档数目
对每篇训练文档：
    对每个类别：
        如果词条出现在文档中 --&gt; 增加该词条的计数值
        增加所有词条的计数值
对每个类别：
    对每个词条：
        将该词条的数目除以总词条数目得到条件概率
返回每个类别的条件概率</code></pre><h4 id="1-准备训练数据"><a href="#1-准备训练数据" class="headerlink" title="1. 准备训练数据"></a>1. 准备训练数据</h4><p>朴素贝叶斯是<code>监督学习</code>的一种算法，因此需要训练数据进行训练从而构建分类器，然后通过构建的分类器对新的数据进行预测。 </p>
<p>假如我们有6条训练数据，也就是有6条包含邮件文本内容的数据，而且每条数据都已经有了是否是垃圾邮件的<code>标签</code>，<code>1</code>表示<code>垃圾邮件</code>，<code>0</code>表示<code>正常邮件</code>。 </p>
<p>以下方法加载训练数据及对应标签：</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">loadDataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    postingList <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">'my'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'has'</span><span class="token punctuation">,</span> <span class="token string">'flea'</span><span class="token punctuation">,</span> <span class="token string">'problems'</span><span class="token punctuation">,</span> <span class="token string">'help'</span><span class="token punctuation">,</span> <span class="token string">'please'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'maybe'</span><span class="token punctuation">,</span> <span class="token string">'not'</span><span class="token punctuation">,</span> <span class="token string">'take'</span><span class="token punctuation">,</span> <span class="token string">'him'</span><span class="token punctuation">,</span> <span class="token string">'to'</span> <span class="token punctuation">,</span><span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'park'</span><span class="token punctuation">,</span> <span class="token string">'stupid'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'my'</span><span class="token punctuation">,</span> <span class="token string">'dalmation'</span><span class="token punctuation">,</span> <span class="token string">'is'</span><span class="token punctuation">,</span> <span class="token string">'so'</span><span class="token punctuation">,</span> <span class="token string">'cute'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token string">'love'</span><span class="token punctuation">,</span> <span class="token string">'hime'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'stop'</span><span class="token punctuation">,</span> <span class="token string">'posting'</span><span class="token punctuation">,</span> <span class="token string">'stupid'</span><span class="token punctuation">,</span> <span class="token string">'worthless'</span><span class="token punctuation">,</span> <span class="token string">'garbage'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'mr'</span><span class="token punctuation">,</span> <span class="token string">'licks'</span><span class="token punctuation">,</span> <span class="token string">'ate'</span><span class="token punctuation">,</span> <span class="token string">'my'</span><span class="token punctuation">,</span> <span class="token string">'steak'</span><span class="token punctuation">,</span> <span class="token string">'how'</span><span class="token punctuation">,</span> <span class="token string">'to'</span><span class="token punctuation">,</span> <span class="token string">'stop'</span><span class="token punctuation">,</span> <span class="token string">'him'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">'quit'</span><span class="token punctuation">,</span> <span class="token string">'bying'</span><span class="token punctuation">,</span> <span class="token string">'worthless'</span><span class="token punctuation">,</span> <span class="token string">'dog'</span><span class="token punctuation">,</span> <span class="token string">'food'</span><span class="token punctuation">,</span> <span class="token string">'stupid'</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
    classVec <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> postingList<span class="token punctuation">,</span> classVec</code></pre>
<p>该方法返回了<code>训练数据集</code>，以及对应<code>标签</code>。 </p>
<p>接下来从训练数据中提取词汇表。所谓<code>词汇表</code>，就是包含在所有文档中出现的不重复词的列表。</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">createVocabList</span><span class="token punctuation">(</span>dataSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    vocabSet <span class="token operator">=</span> set<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> document <span class="token keyword">in</span> dataSet<span class="token punctuation">:</span>
        vocabSet <span class="token operator">=</span> vocabSet <span class="token operator">|</span> set<span class="token punctuation">(</span>document<span class="token punctuation">)</span>
    <span class="token keyword">return</span> list<span class="token punctuation">(</span>vocabSet<span class="token punctuation">)</span></code></pre>
<p>该方法传入数据集，返回数据集中所有出现的不重复词的列表。 </p>
<p>接下来，计算<code>文档向量</code>。文档向量的长度与词汇表相同，向量每一个元素为<code>1</code>或<code>0</code>，分别表示词汇表中的单词<code>是否在文档中出现</code>。</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">setOfWords2Vec</span><span class="token punctuation">(</span>vocabList<span class="token punctuation">,</span> inputSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    returnVec <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>vocabList<span class="token punctuation">)</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> inputSet<span class="token punctuation">:</span>
        <span class="token keyword">if</span> word <span class="token keyword">in</span> vocabList<span class="token punctuation">:</span>
            returnVec<span class="token punctuation">[</span>vocabList<span class="token punctuation">.</span>index<span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the word: %s is not in my Vocabulary!'</span> <span class="token operator">%</span> word<span class="token punctuation">)</span>
    <span class="token keyword">return</span> returnVec</code></pre>
<p>现在来看一下上面这三个函数的运行效果。</p>
<pre class=" language-python"><code class="language-python">listPosts<span class="token punctuation">,</span> listClasses <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>
myVocabList <span class="token operator">=</span> createVocabList<span class="token punctuation">(</span>listPosts<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myVocabList<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> listPosts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> listPosts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>输出如下：</p>
<pre><code>[&#39;help&#39;, &#39;please&#39;, &#39;love&#39;, &#39;steak&#39;, &#39;cute&#39;, &#39;posting&#39;, &#39;has&#39;, &#39;problems&#39;, &#39;i&#39;, &#39;stop&#39;, &#39;so&#39;, &#39;him&#39;, &#39;bying&#39;, &#39;my&#39;, &#39;dalmation&#39;, &#39;ate&#39;, &#39;dog&#39;, &#39;take&#39;, &#39;quit&#39;, &#39;maybe&#39;, &#39;mr&#39;, &#39;food&#39;, &#39;hime&#39;, &#39;stupid&#39;, &#39;to&#39;, &#39;garbage&#39;, &#39;flea&#39;, &#39;not&#39;, &#39;is&#39;, &#39;licks&#39;, &#39;how&#39;, &#39;park&#39;, &#39;worthless&#39;]
[1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0]
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0]</code></pre><p>可以看到，<code>词向量</code>已经创建好了，通过<code>1</code>或<code>0</code>表示文档中每个单词在词汇表中<code>出现</code>或<code>不出现</code>，因此词向量的长度与词汇表的长度是相同的。</p>
<h4 id="2-训练算法"><a href="#2-训练算法" class="headerlink" title="2. 训练算法"></a>2. 训练算法</h4><p>接下来通过Python3实现前面的伪代码，求每个类别中每个单词的<code>条件概率</code>，这实际上就是对算法进行训练，因为我们通过训练数据得到的各个条件概率将用于对新数据进行<code>预测</code>。 </p>
<p><code>训练算法</code>的实现代码如下：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 训练算法</span>
<span class="token comment" spellcheck="true"># trainMatrix: 训练数据，也就是前面得到的词向量</span>
<span class="token comment" spellcheck="true"># trainCategory: 训练数据的标签</span>
<span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>trainMatrix<span class="token punctuation">,</span> trainCategory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 训练数据中包含的文档个数</span>
    numTrainDocs <span class="token operator">=</span> len<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 每条训练数据中单词个数，等于词汇表的长度</span>
    numWords <span class="token operator">=</span> len<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 训练数据中类别1的概率，也就是垃圾邮件的概率</span>
    <span class="token comment" spellcheck="true"># 这里比较巧妙的使用了sum()函数得到类别1的文档个数</span>
    pAbusive <span class="token operator">=</span> sum<span class="token punctuation">(</span>trainCategory<span class="token punctuation">)</span> <span class="token operator">/</span> float<span class="token punctuation">(</span>numTrainDocs<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 创建两个向量，大小均为词汇表长度</span>
    <span class="token comment" spellcheck="true"># p0Num向量表示为类别0的所有文档各个词出现的总次数</span>
    p0Num <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>numWords<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># p1Num向量表示类别1的所有文档各个词出现的总次数</span>
    p1Num <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>numWords<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># p0Denom为类别0的所有文档的所有词总数</span>
    p0Denom <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token comment" spellcheck="true"># p1Denom为类别1的所有文档的所有词总数</span>
    p1Denom <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token comment" spellcheck="true"># 循环所有文档，累计p0Num，p1Num，p0Denom，p1Denom</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>numTrainDocs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> trainCategory<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            p1Num <span class="token operator">+=</span> trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            p1Denom <span class="token operator">+=</span> sum<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            p0Num <span class="token operator">+=</span> trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            p0Denom <span class="token operator">+=</span> sum<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 计算各个类别的条件概率</span>
    <span class="token comment" spellcheck="true"># p1Vect为类别1的条件概率</span>
    p1Vect <span class="token operator">=</span> p1Num<span class="token operator">/</span>p1Denom
    <span class="token comment" spellcheck="true"># p0Vect为类别0的条件概率</span>
    p0Vect <span class="token operator">=</span> p0Num<span class="token operator">/</span>p0Denom
    <span class="token comment" spellcheck="true"># 返回三个概率</span>
    <span class="token keyword">return</span> p0Vect<span class="token punctuation">,</span> p1Vect<span class="token punctuation">,</span> pAbusive</code></pre>
<p>测试一下该函数。首先将训练文档转换为<code>文档向量</code>：</p>
<pre class=" language-python"><code class="language-python">trainMat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> postingDoc <span class="token keyword">in</span> listPosts<span class="token punctuation">:</span>
    trainMat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> postingDoc<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>接下来运行训练函数：</p>
<pre class=" language-python"><code class="language-python">p0V<span class="token punctuation">,</span> p1V<span class="token punctuation">,</span> pAb <span class="token operator">=</span> train<span class="token punctuation">(</span>trainMat<span class="token punctuation">,</span> listClasses<span class="token punctuation">)</span></code></pre>
<p>打印三个概率来看看：</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>pAb<span class="token punctuation">)</span></code></pre>
<pre><code>0.5</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p0V<span class="token punctuation">)</span></code></pre>
<pre><code>[0.         0.04166667 0.04166667 0.04166667 0.04166667 0.
 0.04166667 0.04166667 0.04166667 0.         0.04166667 0.
 0.04166667 0.         0.04166667 0.04166667 0.04166667 0.
 0.         0.04166667 0.         0.         0.04166667 0.04166667
 0.04166667 0.         0.125      0.04166667 0.04166667 0.04166667
 0.04166667 0.         0.04166667]</code></pre><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>p1V<span class="token punctuation">)</span></code></pre>
<pre><code>[0.05263158 0.         0.         0.         0.10526316 0.10526316
 0.         0.         0.         0.05263158 0.05263158 0.05263158
 0.         0.05263158 0.05263158 0.         0.         0.05263158
 0.05263158 0.05263158 0.05263158 0.15789474 0.         0.
 0.         0.05263158 0.         0.         0.         0.
 0.         0.05263158 0.        ]</code></pre><p>可以看到，有很多概率为<code>0</code>。而我们用朴素贝叶斯进行文档分类时，需要计算多个概率的<code>乘积</code>，也就是计算$P(w_1|c_i)P(w_2|c_i) … P(w_n|c_i)P(c_i)$。如果其中有一个概率为<code>0</code>，整个计算结果将也为<code>0</code>，这样的话一个词的概率有可能影响到整个结果。为了降低影响，可以将所有词出现次数初始化为<code>1</code>，并将分母初始化为<code>2</code>。 将<code>train()</code>函数的第<code>14，16，18，20</code>行分别修改为：</p>
<pre class=" language-python"><code class="language-python">p0Num <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>numWords<span class="token punctuation">)</span>
p1Num <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>numWords<span class="token punctuation">)</span>
p0Denom <span class="token operator">=</span> <span class="token number">2.0</span>
p1Denom <span class="token operator">=</span> <span class="token number">2.0</span></code></pre>
<p>另外，由于大多数词出现次数会非常少，导致很多概率都非常小，最后很多概率的乘积结果会更小，Python中四舍五入后得到<code>0</code>，因此可能导致所有分类的概率都为<code>0</code>，从而无法用于判断哪个分类概率大，哪个小。为了避免这个影响，可以对概率乘积取<code>自然对数</code>。 </p>
<p>也就是： </p>
<p>$$ln(P(w_1|c_i)P(w_2|c_i) … P(w_n|c_i)P(c_i))$$ </p>
<p>根据代数对数公式：$ln(a*b) = ln(a) + ln(b)$ ，上面公式可以转换为： </p>
<p>$$ln(P(w_1|c_i)P(w_2|c_i) … P(w_n|c_i)P(c_i)) = ln(P(w_1|c_i)) + ln(P(w_2|c_i)) + … + ln(P(c_i))$$ </p>
<p>因此我们可以对每个概率求<code>自然对数</code>，最后再<code>求和</code>。 </p>
<p>将<code>train()</code>函数的第<code>31</code>和<code>33</code>行修改为如下，得到概率的<code>自然对数</code>。</p>
<pre class=" language-python"><code class="language-python">p1Vect <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p1Num<span class="token operator">/</span>p1Denom<span class="token punctuation">)</span>
p0Vect <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p0Num<span class="token operator">/</span>p0Denom<span class="token punctuation">)</span></code></pre>
<p>再次列出修改后的完整的<code>train()</code>函数：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 训练算法</span>
<span class="token comment" spellcheck="true"># trainMatrix: 训练数据，也就是前面得到的词向量</span>
<span class="token comment" spellcheck="true"># trainCategory: 训练数据的标签</span>
<span class="token keyword">def</span> <span class="token function">train</span><span class="token punctuation">(</span>trainMatrix<span class="token punctuation">,</span> trainCategory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 训练数据中包含的文档个数</span>
    numTrainDocs <span class="token operator">=</span> len<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 每条训练数据中单词个数，等于词汇表的长度</span>
    numWords <span class="token operator">=</span> len<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 训练数据中类别1的概率，也就是垃圾邮件的概率</span>
    <span class="token comment" spellcheck="true"># 这里比较巧妙的使用了sum()函数得到类别1的文档个数</span>
    pAbusive <span class="token operator">=</span> sum<span class="token punctuation">(</span>trainCategory<span class="token punctuation">)</span> <span class="token operator">/</span> float<span class="token punctuation">(</span>numTrainDocs<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 创建两个向量，大小均为词汇表长度</span>
    <span class="token comment" spellcheck="true"># p0Num向量表示为类别0的所有文档各个词出现的总次数</span>
    p0Num <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>numWords<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># p1Num向量表示类别1的所有文档各个词出现的总次数</span>
    p1Num <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>numWords<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># p0Denom为类别0的所有文档的所有词总数</span>
    p0Denom <span class="token operator">=</span> <span class="token number">2.0</span>
    <span class="token comment" spellcheck="true"># p1Denom为类别1的所有文档的所有词总数</span>
    p1Denom <span class="token operator">=</span> <span class="token number">2.0</span>
    <span class="token comment" spellcheck="true"># 循环所有文档，累计p0Num，p1Num，p0Denom，p1Denom</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>numTrainDocs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> trainCategory<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            p1Num <span class="token operator">+=</span> trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            p1Denom <span class="token operator">+=</span> sum<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            p0Num <span class="token operator">+=</span> trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            p0Denom <span class="token operator">+=</span> sum<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 计算各个类别的条件概率</span>
    <span class="token comment" spellcheck="true"># p1Vect为类别1的条件概率</span>
    p1Vect <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p1Num<span class="token operator">/</span>p1Denom<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># p0Vect为类别0的条件概率</span>
    p0Vect <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p0Num<span class="token operator">/</span>p0Denom<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 返回三个概率</span>
    <span class="token keyword">return</span> p0Vect<span class="token punctuation">,</span> p1Vect<span class="token punctuation">,</span> pAbusive</code></pre>
<p>再次测试<code>train()</code>函数，得到类似如下结果：</p>
<pre class=" language-python"><code class="language-python">listPosts<span class="token punctuation">,</span> listClasses <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>
myVocabList <span class="token operator">=</span> createVocabList<span class="token punctuation">(</span>listPosts<span class="token punctuation">)</span>
trainMat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> postingDoc <span class="token keyword">in</span> listPosts<span class="token punctuation">:</span>
    trainMat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> postingDoc<span class="token punctuation">)</span><span class="token punctuation">)</span>
p0V<span class="token punctuation">,</span> p1V<span class="token punctuation">,</span> pAb <span class="token operator">=</span> train<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>trainMat<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>listClasses<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pAb<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p0V<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p1V<span class="token punctuation">)</span></code></pre>
<pre><code>0.5
[-2.56494936 -3.25809654 -2.56494936 -3.25809654 -3.25809654 -2.56494936
 -2.56494936 -2.56494936 -2.56494936 -2.56494936 -2.56494936 -2.56494936
 -2.56494936 -2.56494936 -1.87180218 -3.25809654 -3.25809654 -2.56494936
 -3.25809654 -3.25809654 -2.56494936 -2.56494936 -3.25809654 -3.25809654
 -2.56494936 -2.56494936 -2.56494936 -2.56494936 -2.56494936 -3.25809654
 -3.25809654 -2.56494936 -2.56494936]
[-2.35137526 -2.35137526 -3.04452244 -1.65822808 -2.35137526 -3.04452244
 -2.35137526 -3.04452244 -3.04452244 -3.04452244 -2.35137526 -3.04452244
 -3.04452244 -3.04452244 -3.04452244 -2.35137526 -2.35137526 -3.04452244
 -1.94591015 -2.35137526 -3.04452244 -3.04452244 -2.35137526 -2.35137526
 -3.04452244 -3.04452244 -3.04452244 -3.04452244 -3.04452244 -2.35137526
 -2.35137526 -3.04452244 -1.94591015]</code></pre><p>可以看到，所有概率的绝对值都远大于0，这样四舍五入后不会导致都得到0。这里虽然取自然对数后的值都小于0，但这并不会影响最终结果，因为我们最终是要<code>比较大小</code>，而不需要得到精确的各个值。 </p>
<p>接下来实现<code>分类器函数</code>：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 分类器函数</span>
<span class="token comment" spellcheck="true"># vec2Classify 待预测的词向量</span>
<span class="token comment" spellcheck="true"># p0Vec，p1Vec, pClass1分别为train()函数训练输出的三个概率值</span>
<span class="token keyword">def</span> <span class="token function">classify</span><span class="token punctuation">(</span>vec2Classify<span class="token punctuation">,</span> p0Vec<span class="token punctuation">,</span> p1Vec<span class="token punctuation">,</span> pClass1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 待预测数据为类别1的概率，这里利用了前面提到的对数公式</span>
    p1 <span class="token operator">=</span> sum<span class="token punctuation">(</span>vec2Classify <span class="token operator">*</span> p1Vec<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>pClass1<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 待预测数据为类别0的概率，这里利用了前面提到的对数公式</span>
    p0 <span class="token operator">=</span> sum<span class="token punctuation">(</span>vec2Classify <span class="token operator">*</span> p0Vec<span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> pClass1<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 如果p1大于p0，这预测结果为类别1，否则为类别0</span>
    <span class="token keyword">if</span> p1 <span class="token operator">></span> p0<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span></code></pre>
<h4 id="3-测试算法"><a href="#3-测试算法" class="headerlink" title="3. 测试算法"></a>3. 测试算法</h4><p>现在我们可以把前面实现的分类器进行测试了，用它来预测新数据的类别。</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">testing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    listPosts<span class="token punctuation">,</span> listClasses <span class="token operator">=</span> loadDataSet<span class="token punctuation">(</span><span class="token punctuation">)</span>
    myVocabList <span class="token operator">=</span> createVocabList<span class="token punctuation">(</span>listPosts<span class="token punctuation">)</span>
    trainMat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> postingDoc <span class="token keyword">in</span> listPosts<span class="token punctuation">:</span>
        trainMat<span class="token punctuation">.</span>append<span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> postingDoc<span class="token punctuation">)</span><span class="token punctuation">)</span>
    p0V<span class="token punctuation">,</span> p1V<span class="token punctuation">,</span> pAb <span class="token operator">=</span> train<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>trainMat<span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>listClasses<span class="token punctuation">)</span><span class="token punctuation">)</span>
    testEntry <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'love'</span><span class="token punctuation">,</span> <span class="token string">'my'</span><span class="token punctuation">,</span> <span class="token string">'dalmation'</span><span class="token punctuation">]</span>
    thisDoc <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> testEntry<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>testEntry<span class="token punctuation">,</span> <span class="token string">'classified as: '</span><span class="token punctuation">,</span> classify<span class="token punctuation">(</span>thisDoc<span class="token punctuation">,</span> p0V<span class="token punctuation">,</span> p1V<span class="token punctuation">,</span> pAb<span class="token punctuation">)</span><span class="token punctuation">)</span>
    testEntry <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'stupid'</span><span class="token punctuation">,</span> <span class="token string">'garbage'</span><span class="token punctuation">]</span>
    thisDoc <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>setOfWords2Vec<span class="token punctuation">(</span>myVocabList<span class="token punctuation">,</span> testEntry<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>testEntry<span class="token punctuation">,</span> <span class="token string">'classified as: '</span><span class="token punctuation">,</span> classify<span class="token punctuation">(</span>thisDoc<span class="token punctuation">,</span> p0V<span class="token punctuation">,</span> p1V<span class="token punctuation">,</span> pAb<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>输出如下：</p>
<pre><code>[&#39;love&#39;, &#39;my&#39;, &#39;dalmation&#39;] classified as:  0
[&#39;stupid&#39;, &#39;garbage&#39;] classified as:  1</code></pre><p>第一条数据预测为<code>0</code>，即<code>非垃圾邮件</code>。第二条数据预测结果为<code>1</code>，也就是<code>垃圾邮件</code>。可以看到我们的分类器对这两条数据的预测是正确的。</p>
<h4 id="4-优化算法"><a href="#4-优化算法" class="headerlink" title="4. 优化算法"></a>4. 优化算法</h4><p>前面我们将每个单词的出现与否作为一个特征，这种模型叫<code>词集模型</code>。但是这种模型有一个问题，当一个词在一个文档中出现不止一次时，词集模型将不能包含这种出现不止一次的特征信息。因此通常我们会使用<code>词袋模型</code>，这种模型中，会记录每个单词出现的<code>次数</code>，而不仅仅使用单词<code>出现与否</code>作为特征。 </p>
<p>为了实现词袋模型，我们需要对<code>setOfWords2Vec()</code>函数进行修改：</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">setOfWords2Vec</span><span class="token punctuation">(</span>vocabList<span class="token punctuation">,</span> inputSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    returnVec <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> len<span class="token punctuation">(</span>vocabList<span class="token punctuation">)</span>
    <span class="token keyword">for</span> word <span class="token keyword">in</span> inputSet<span class="token punctuation">:</span>
        <span class="token keyword">if</span> word <span class="token keyword">in</span> vocabList<span class="token punctuation">:</span>
            returnVec<span class="token punctuation">[</span>vocabList<span class="token punctuation">.</span>index<span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'the word: %s is not in my Vocabulary!'</span> <span class="token operator">%</span> word<span class="token punctuation">)</span>
    <span class="token keyword">return</span> returnVec</code></pre>
<p>可以看到，我们仅仅修改了第<code>5</code>行代码，每当遇到一个单词时，会增加词向量中对应的值，而不只是把对应的值设为<code>1</code>。 </p>
<p>可以再次运行一下测试程序，你将看到预测结果跟之前是一致且正确的。</p>
<h3 id="五、小结"><a href="#五、小结" class="headerlink" title="五、小结"></a>五、小结</h3><p>完整代码请在<a href="https://github.com/longyg/Machine-Learning-Practice/tree/master/Bayes" target="_blank" rel="noopener">此处下载</a>。 </p>
<p><code>朴素贝叶斯算法</code>在分类应用中用的非常广泛，该算法核心是基于概率，通过计算各个类别的<code>条件概率</code>，以概率最大的类别作为预测的类别，因此该算法很容易理解，而且实现也很简单。</p>

            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">yglong</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://www.yglong.com/posts/ml/mlp-4-bayes.html">http://www.yglong.com/posts/ml/mlp-4-bayes.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">yglong</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                                    <span class="chip bg-color">机器学习</span>
                                </a>
                            
                                <a href="/tags/%E7%AE%97%E6%B3%95/">
                                    <span class="chip bg-color">算法</span>
                                </a>
                            
                                <a href="/tags/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/">
                                    <span class="chip bg-color">朴素贝叶斯</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '357fc628d86fb45f7082',
        clientSecret: '7d50d35a5764740c102b798f24a2921cf9e5e111',
        repo: 'blog-comments',
        owner: 'longyg',
        admin: "longyg",
        id: '2018-09-16T16-53-29',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/sharing/kubernetes-get-started.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="Kubernetes入门：使用kubeadm在ubuntu上安装kubernetes">
                        
                        <span class="card-title">Kubernetes入门：使用kubeadm在ubuntu上安装kubernetes</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            本文介绍了使用 kubeadm 在 Ubuntu 上安装 Kubernetes
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2018-12-13
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB/" class="post-category">
                                    经验分享
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Kubernetes/">
                        <span class="chip bg-color">Kubernetes</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/ml/mlp-3-decision-tree.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/8.jpg" class="responsive-img" alt="《机器学习实战》读书笔记之三：决策树">
                        
                        <span class="card-title">《机器学习实战》读书笔记之三：决策树</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            本文将详细介绍如何根据训练数据构造决策树，然后通过决策树创建分类器，最后通过实际案例测试分类器的预测效果。
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2018-08-05
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="post-category">
                                    机器学习
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
                        <span class="chip bg-color">机器学习</span>
                    </a>
                    
                    <a href="/tags/%E7%AE%97%E6%B3%95/">
                        <span class="chip bg-color">算法</span>
                    </a>
                    
                    <a href="/tags/%E5%86%B3%E7%AD%96%E6%A0%91/">
                        <span class="chip bg-color">决策树</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="3754812570"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2018</span>
            <a href="/about" target="_blank">yglong</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">60.9k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2018";
                    var startMonth = "5";
                    var startDate = "20";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/longyg" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:longyg1986@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=373020902" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 373020902" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/search.xml", 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
